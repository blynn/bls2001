/* f3k.cc
  Holds lookup tables for operations in F_3^k
*/
/*
Copyright (C) 2001 Benjamin Lynn (blynn@cs.stanford.edu)

This file is part of the Stanford short signature system.

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.
*/
//Irred poly = [1 1 1 2 0 1 1]
int discretelog[] = {
    -729, 0, 364, 632, 293, 186, 268, 550, 657, 536, 
    628, 479, 197, 372, 430, 90, 586, 659, 172, 115, 
    264, 454, 295, 222, 561, 66, 8, 440, 151, 558, 
    532, 616, 224, 383, 447, 535, 101, 117, 296, 276, 
    193, 576, 334, 675, 44, 722, 595, 723, 490, 502, 
    86, 563, 665, 541, 76, 194, 515, 19, 171, 83, 
    168, 588, 252, 358, 359, 231, 199, 177, 301, 126, 
    450, 138, 465, 660, 481, 698, 408, 311, 640, 212, 
    557, 344, 361, 379, 55, 34, 114, 462, 67, 717, 
    436, 230, 317, 520, 120, 106, 128, 491, 133, 287, 
    528, 649, 351, 160, 303, 439, 482, 288, 5, 727, 
    236, 21, 444, 330, 200, 121, 123, 180, 315, 517, 
    97, 23, 53, 480, 181, 325, 238, 12, 688, 579, 
    272, 100, 676, 590, 716, 626, 240, 427, 499, 184, 
    337, 627, 16, 559, 394, 341, 74, 406, 410, 514, 
    718, 136, 589, 467, 721, 141, 569, 132, 274, 445, 
    486, 633, 708, 15, 725, 98, 353, 431, 419, 478, 
    398, 651, 285, 164, 75, 652, 118, 715, 667, 524, 
    72, 681, 594, 492, 497, 127, 156, 470, 484, 262, 
    63, 604, 263, 195, 380, 135, 701, 548, 103, 505, 
    357, 81, 269, 122, 205, 638, 496, 30, 438, 705, 
    354, 225, 500, 42, 150, 46, 369, 600, 363, 564, 
    487, 485, 385, 694, 80, 602, 324, 376, 312, 352, 
    226, 215, 464, 636, 544, 153, 679, 116, 689, 545, 
    461, 417, 387, 248, 429, 209, 265, 239, 154, 283, 
    41, 552, 687, 511, 606, 666, 634, 157, 18, 347, 
    367, 366, 243, 79, 699, 161, 501, 621, 703, 435, 
    340, 174, 567, 134, 206, 451, 221, 425, 48, 424, 
    51, 469, 24, 227, 198, 10, 146, 235, 32, 615, 
    458, 395, 286, 297, 37, 635, 434, 191, 507, 204, 
    432, 533, 185, 553, 422, 720, 255, 697, 630, 64, 
    516, 345, 207, 477, 145, 343, 309, 59, 386, 551, 
    124, 192, 92, 307, 637, 91, 182, 631, 654, 320, 
    140, 392, 672, 653, 577, 407, 348, 611, 179, 234, 
    327, 397, 104, 360, 318, 25, 460, 282, 27, 575, 
    526, 84, 56, 196, 219, 332, 426, 421, 613, 149, 
    1, 237, 370, 655, 523, 433, 685, 170, 610, 384, 
    17, 399, 85, 475, 210, 229, 413, 202, 142, 73, 
    596, 644, 700, 476, 592, 453, 218, 483, 47, 641, 
    176, 459, 581, 4, 472, 322, 580, 690, 223, 494, 
    93, 527, 620, 260, 214, 530, 554, 393, 144, 663, 
    547, 331, 565, 294, 403, 155, 220, 88, 300, 281, 
    241, 726, 441, 531, 175, 597, 648, 305, 250, 463, 
    702, 253, 298, 495, 306, 245, 292, 522, 706, 466, 
    529, 310, 319, 623, 314, 692, 572, 418, 9, 677, 
    622, 414, 378, 40, 278, 416, 493, 503, 275, 371, 
    474, 512, 625, 402, 618, 45, 719, 668, 473, 442, 
    11, 36, 608, 714, 178, 107, 82, 349, 693, 346, 
    390, 489, 643, 537, 316, 377, 612, 573, 65, 647, 
    188, 405, 629, 518, 603, 2, 443, 607, 257, 71, 
    339, 335, 137, 525, 323, 242, 147, 382, 3, 711, 
    302, 521, 270, 555, 568, 143, 189, 356, 58, 68, 
    549, 169, 707, 423, 673, 556, 671, 456, 22, 488, 
    187, 619, 266, 333, 571, 509, 113, 428, 709, 152, 
    704, 203, 538, 585, 412, 61, 498, 87, 570, 396, 
    94, 251, 401, 70, 271, 31, 661, 650, 60, 105, 
    415, 374, 599, 510, 388, 562, 591, 166, 29, 190, 
    695, 658, 201, 508, 183, 299, 167, 233, 539, 99, 
    617, 338, 284, 614, 669, 39, 584, 519, 605, 77, 
    362, 452, 645, 664, 7, 148, 110, 409, 304, 355, 
    261, 254, 38, 713, 710, 329, 173, 13, 680, 26, 
    279, 125, 109, 375, 78, 542, 446, 471, 400, 350, 
    244, 662, 670, 131, 342, 165, 102, 609, 158, 656, 
    258, 14, 50, 129, 639, 139, 404, 52, 642, 674, 
    259, 683, 54, 313, 373, 678, 208, 328, 273, 546, 
    455, 504, 308, 28, 267, 684, 290, 468, 682, 724, 
    391, 162, 211, 389, 646, 96, 289, 43, 213, 598, 
    33, 691, 712, 543, 247, 506, 232, 437, 228, 582, 
    89, 280, 112, 336, 216, 587, 326, 256, 578, 624, 
    130, 163, 457, 119, 277, 411, 368, 686, 108, 540, 
    217, 95, 448, 560, 420, 57, 513, 249, 583, 62, 
    696, 20, 35, 381, 593, 566, 49, 449, 574, 111, 
    365, 6, 601, 321, 246, 534, 291, 69, 159
};

int antilog[] = {
    1, 360, 495, 508, 393, 108, 721, 594, 26, 448, 
    285, 470, 127, 607, 631, 163, 142, 370, 258, 57, 
    711, 111, 528, 121, 282, 345, 609, 348, 653, 568, 
    207, 555, 288, 670, 85, 712, 471, 294, 602, 585, 
    453, 250, 213, 667, 44, 465, 215, 388, 278, 716, 
    632, 280, 637, 122, 642, 84, 352, 705, 518, 317, 
    558, 545, 709, 190, 309, 488, 25, 88, 519, 727, 
    553, 499, 180, 379, 146, 174, 54, 589, 614, 263, 
    224, 201, 476, 59, 351, 372, 50, 547, 417, 680, 
    15, 325, 322, 400, 550, 701, 665, 120, 165, 579, 
    131, 36, 626, 198, 342, 559, 95, 475, 698, 612, 
    596, 719, 682, 536, 86, 19, 237, 37, 176, 693, 
    94, 115, 203, 116, 320, 611, 69, 185, 96, 633, 
    690, 623, 157, 98, 273, 195, 151, 502, 71, 635, 
    330, 155, 378, 515, 408, 314, 286, 506, 595, 359, 
    214, 28, 539, 235, 248, 415, 186, 257, 628, 728, 
    103, 265, 661, 691, 173, 625, 567, 576, 60, 521, 
    367, 58, 18, 606, 271, 424, 390, 67, 474, 338, 
    117, 124, 326, 574, 139, 302, 5, 530, 490, 516, 
    569, 297, 321, 40, 55, 193, 353, 12, 284, 66, 
    114, 572, 377, 541, 299, 204, 274, 312, 646, 245, 
    374, 662, 79, 668, 404, 231, 684, 700, 386, 354, 
    416, 276, 23, 398, 32, 211, 230, 283, 678, 375, 
    91, 65, 676, 577, 339, 287, 110, 361, 126, 247, 
    136, 420, 505, 262, 620, 435, 724, 674, 243, 707, 
    428, 551, 62, 431, 601, 306, 687, 498, 630, 640, 
    403, 600, 189, 192, 20, 246, 532, 654, 6, 202, 
    512, 554, 130, 648, 158, 458, 39, 694, 454, 610, 
    681, 419, 347, 249, 582, 172, 292, 99, 107, 666, 
    656, 726, 436, 4, 413, 22, 38, 293, 432, 575, 
    418, 68, 510, 104, 598, 427, 434, 323, 652, 316, 
    441, 77, 228, 643, 444, 118, 484, 92, 344, 442, 
    329, 723, 395, 504, 226, 125, 686, 340, 647, 605, 
    113, 411, 355, 533, 42, 501, 683, 140, 581, 500, 
    270, 145, 624, 315, 81, 311, 479, 259, 336, 477, 
    619, 102, 229, 166, 210, 599, 517, 200, 63, 64, 
    343, 82, 590, 218, 2, 720, 261, 260, 696, 216, 
    362, 459, 13, 644, 561, 613, 227, 485, 452, 83, 
    194, 713, 507, 33, 369, 222, 318, 242, 564, 663, 
    480, 660, 331, 407, 144, 291, 549, 341, 170, 371, 
    618, 552, 463, 414, 636, 491, 147, 335, 76, 597, 
    148, 695, 544, 376, 451, 560, 455, 241, 447, 168, 
    704, 357, 304, 523, 279, 277, 356, 137, 537, 244, 
    14, 167, 300, 365, 296, 269, 90, 677, 208, 105, 
    27, 422, 469, 496, 112, 159, 616, 34, 702, 717, 
    70, 275, 591, 385, 21, 650, 527, 692, 290, 391, 
    346, 240, 87, 429, 232, 72, 439, 153, 657, 281, 
    187, 617, 394, 468, 460, 373, 383, 313, 169, 11, 
    123, 74, 106, 387, 188, 221, 160, 220, 529, 481, 
    48, 97, 183, 456, 399, 433, 206, 184, 546, 138, 
    212, 266, 49, 457, 651, 199, 675, 298, 573, 535, 
    563, 253, 461, 706, 149, 56, 310, 119, 493, 587, 
    93, 511, 437, 364, 179, 503, 350, 401, 100, 440, 
    405, 423, 30, 301, 725, 35, 9, 483, 542, 578, 
    699, 53, 615, 673, 234, 239, 649, 410, 197, 520, 
    7, 319, 251, 303, 406, 513, 525, 80, 29, 143, 
    703, 24, 565, 51, 219, 412, 715, 272, 514, 156, 
    548, 534, 446, 487, 718, 349, 41, 334, 688, 129, 
    396, 392, 679, 708, 586, 543, 16, 685, 61, 152, 
    133, 566, 384, 714, 182, 46, 380, 425, 669, 562, 
    217, 722, 225, 494, 191, 588, 254, 497, 472, 627, 
    368, 337, 486, 358, 583, 289, 31, 580, 464, 531, 
    402, 267, 450, 443, 689, 462, 135, 141, 10, 492, 
    308, 327, 3, 161, 256, 295, 233, 324, 205, 634, 
    78, 389, 638, 482, 381, 592, 664, 489, 426, 101, 
    557, 171, 175, 333, 328, 363, 629, 8, 571, 17, 
    73, 556, 621, 409, 593, 52, 255, 178, 467, 584, 
    622, 526, 332, 524, 639, 43, 132, 449, 645, 236, 
    608, 181, 658, 641, 655, 366, 697, 252, 128, 238, 
    397, 671, 445, 478, 223, 570, 710, 307, 75, 264, 
    382, 196, 430, 268, 540, 209, 438, 522, 162, 538, 
    604, 509, 672, 603, 473, 177, 134, 89, 150, 466, 
    305, 154, 45, 47, 659, 164, 421, 109, 
    1, 360, 495, 508, 393, 108, 721, 594, 26, 448, 
    285, 470, 127, 607, 631, 163, 142, 370, 258, 57, 
    711, 111, 528, 121, 282, 345, 609, 348, 653, 568, 
    207, 555, 288, 670, 85, 712, 471, 294, 602, 585, 
    453, 250, 213, 667, 44, 465, 215, 388, 278, 716, 
    632, 280, 637, 122, 642, 84, 352, 705, 518, 317, 
    558, 545, 709, 190, 309, 488, 25, 88, 519, 727, 
    553, 499, 180, 379, 146, 174, 54, 589, 614, 263, 
    224, 201, 476, 59, 351, 372, 50, 547, 417, 680, 
    15, 325, 322, 400, 550, 701, 665, 120, 165, 579, 
    131, 36, 626, 198, 342, 559, 95, 475, 698, 612, 
    596, 719, 682, 536, 86, 19, 237, 37, 176, 693, 
    94, 115, 203, 116, 320, 611, 69, 185, 96, 633, 
    690, 623, 157, 98, 273, 195, 151, 502, 71, 635, 
    330, 155, 378, 515, 408, 314, 286, 506, 595, 359, 
    214, 28, 539, 235, 248, 415, 186, 257, 628, 728, 
    103, 265, 661, 691, 173, 625, 567, 576, 60, 521, 
    367, 58, 18, 606, 271, 424, 390, 67, 474, 338, 
    117, 124, 326, 574, 139, 302, 5, 530, 490, 516, 
    569, 297, 321, 40, 55, 193, 353, 12, 284, 66, 
    114, 572, 377, 541, 299, 204, 274, 312, 646, 245, 
    374, 662, 79, 668, 404, 231, 684, 700, 386, 354, 
    416, 276, 23, 398, 32, 211, 230, 283, 678, 375, 
    91, 65, 676, 577, 339, 287, 110, 361, 126, 247, 
    136, 420, 505, 262, 620, 435, 724, 674, 243, 707, 
    428, 551, 62, 431, 601, 306, 687, 498, 630, 640, 
    403, 600, 189, 192, 20, 246, 532, 654, 6, 202, 
    512, 554, 130, 648, 158, 458, 39, 694, 454, 610, 
    681, 419, 347, 249, 582, 172, 292, 99, 107, 666, 
    656, 726, 436, 4, 413, 22, 38, 293, 432, 575, 
    418, 68, 510, 104, 598, 427, 434, 323, 652, 316, 
    441, 77, 228, 643, 444, 118, 484, 92, 344, 442, 
    329, 723, 395, 504, 226, 125, 686, 340, 647, 605, 
    113, 411, 355, 533, 42, 501, 683, 140, 581, 500, 
    270, 145, 624, 315, 81, 311, 479, 259, 336, 477, 
    619, 102, 229, 166, 210, 599, 517, 200, 63, 64, 
    343, 82, 590, 218, 2, 720, 261, 260, 696, 216, 
    362, 459, 13, 644, 561, 613, 227, 485, 452, 83, 
    194, 713, 507, 33, 369, 222, 318, 242, 564, 663, 
    480, 660, 331, 407, 144, 291, 549, 341, 170, 371, 
    618, 552, 463, 414, 636, 491, 147, 335, 76, 597, 
    148, 695, 544, 376, 451, 560, 455, 241, 447, 168, 
    704, 357, 304, 523, 279, 277, 356, 137, 537, 244, 
    14, 167, 300, 365, 296, 269, 90, 677, 208, 105, 
    27, 422, 469, 496, 112, 159, 616, 34, 702, 717, 
    70, 275, 591, 385, 21, 650, 527, 692, 290, 391, 
    346, 240, 87, 429, 232, 72, 439, 153, 657, 281, 
    187, 617, 394, 468, 460, 373, 383, 313, 169, 11, 
    123, 74, 106, 387, 188, 221, 160, 220, 529, 481, 
    48, 97, 183, 456, 399, 433, 206, 184, 546, 138, 
    212, 266, 49, 457, 651, 199, 675, 298, 573, 535, 
    563, 253, 461, 706, 149, 56, 310, 119, 493, 587, 
    93, 511, 437, 364, 179, 503, 350, 401, 100, 440, 
    405, 423, 30, 301, 725, 35, 9, 483, 542, 578, 
    699, 53, 615, 673, 234, 239, 649, 410, 197, 520, 
    7, 319, 251, 303, 406, 513, 525, 80, 29, 143, 
    703, 24, 565, 51, 219, 412, 715, 272, 514, 156, 
    548, 534, 446, 487, 718, 349, 41, 334, 688, 129, 
    396, 392, 679, 708, 586, 543, 16, 685, 61, 152, 
    133, 566, 384, 714, 182, 46, 380, 425, 669, 562, 
    217, 722, 225, 494, 191, 588, 254, 497, 472, 627, 
    368, 337, 486, 358, 583, 289, 31, 580, 464, 531, 
    402, 267, 450, 443, 689, 462, 135, 141, 10, 492, 
    308, 327, 3, 161, 256, 295, 233, 324, 205, 634, 
    78, 389, 638, 482, 381, 592, 664, 489, 426, 101, 
    557, 171, 175, 333, 328, 363, 629, 8, 571, 17, 
    73, 556, 621, 409, 593, 52, 255, 178, 467, 584, 
    622, 526, 332, 524, 639, 43, 132, 449, 645, 236, 
    608, 181, 658, 641, 655, 366, 697, 252, 128, 238, 
    397, 671, 445, 478, 223, 570, 710, 307, 75, 264, 
    382, 196, 430, 268, 540, 209, 438, 522, 162, 538, 
    604, 509, 672, 603, 473, 177, 134, 89, 150, 466, 
    305, 154, 45, 47, 659, 164, 421, 109
};

int addtable[] = {
    364, 237, 443, 711, 472, 727, 601, 148, 561, 677, 
    146, 473, 688, 680, 50, 725, 559, 399, 347, 171, 
    35, 444, 488, 53, 227, 460, 279, 575, 504, 190, 
    438, 661, 615, 691, 114, 381, 608, 635, 261, 584, 
    278, 552, 150, 213, 334, 719, 42, 641, 221, 593, 
    258, 469, 642, 97, 313, 34, 196, 513, 189, 343, 
    105, 585, 696, 604, 516, 612, 8, 717, 549, 159, 
    271, 339, 681, 596, 394, 652, 194, 362, 109, 366, 
    385, 269, 178, 19, 56, 475, 490, 570, 300, 228, 
    586, 182, 307, 527, 251, 540, 389, 23, 353, 617, 
    579, 117, 342, 505, 360, 415, 520, 82, 368, 375, 
    7, 449, 336, 571, 55, 264, 689, 296, 75, 277, 
    106, 123, 81, 200, 386, 26, 450, 492, 491, 639, 
    163, 662, 274, 128, 206, 701, 589, 525, 126, 129, 
    392, 467, 73, 555, 663, 207, 235, 323, 110, 421, 
    46, 558, 428, 679, 265, 220, 470, 666, 656, 291, 
    303, 501, 211, 457, 651, 102, 29, 233, 588, 68, 
    610, 83, 115, 13, 567, 597, 459, 301, 107, 348, 
    315, 325, 637, 299, 337, 432, 632, 22, 405, 356, 
    166, 507, 92, 576, 515, 380, 84, 372, 24, 177, 
    121, 695, 229, 538, 191, 638, 451, 477, 328, 248, 
    85, 391, 557, 289, 620, 464, 587, 95, 592, 332, 
    403, 425, 454, 580, 532, 500, 312, 198, 582, 413, 
    317, 358, 437, 539, 327, 10, 5, 370, 12, 154, 
    427, 726, 147, 79, 400, 292, 534, 712, 429, 57, 
    648, 396, 168, 463, 38, 697, 578, 71, 14, 683, 
    214, 254, 63, 195, 172, 239, 333, 684, 550, 122, 
    302, 401, 100, 546, 569, 493, 193, 411, 416, 125, 
    112, 88, 25, 41, 614, 164, 297, 528, 439, 43, 
    267, 69, 522, 186, 331, 222, 101, 395, 495, 508, 
    281, 199, 521, 351, 355, 250, 298, 192, 28, 59, 
    319, 698, 352, 373, 692, 517, 377, 436, 104, 623, 
    631, 246, 4, 242, 376, 480, 216, 397, 678, 713, 
    21, 565, 426, 619, 675, 137, 280, 499, 99, 257, 
    174, 74, 165, 309, 361, 64, 349, 367, 611, 693, 
    244, 160, 226, 431, 225, 409, 58, 103, 359, 231, 
    318, 379, 605, 369, -729, 6, 243, 18, 686, 600, 
    1, 474, 430, 54, 599, 78, 602, 537, 622, 344, 
    263, 20, 3, 447, 17, 694, 551, 461, 562, 646, 
    489, 162, 672, 530, 341, 286, 94, 234, 419, 384, 
    350, 70, 618, 155, 52, 647, 410, 653, 311, 304, 
    514, 119, 61, 202, 378, 60, 40, 387, 9, 478, 
    448, 613, 720, 673, 51, 48, 219, 626, 709, 209, 
    197, 98, 533, 655, 37, 621, 230, 506, 705, 482, 
    151, 241, 11, 607, 330, 486, 471, 535, 560, 574, 
    138, 134, 645, 218, 295, 273, 556, 130, 32, 581, 
    282, 417, 67, 702, 636, 660, 529, 721, 682, 424, 
    484, 542, 322, 442, 512, 210, 644, 145, 398, 536, 
    181, 465, 288, 47, 156, 564, 633, 485, 187, 643, 
    502, 133, 497, 503, 93, 306, 205, 127, 87, 184, 
    354, 699, 86, 275, 308, 357, 232, 204, 183, 113, 
    374, 606, 371, 249, 406, 76, 345, 180, 603, 39, 
    120, 270, 245, 433, 715, 335, 27, 494, 649, 706, 
    554, 175, 616, 185, 321, 383, 628, 316, 704, 167, 
    217, 563, 446, 247, 153, 116, 455, 144, 135, 169, 
    657, 124, 283, 422, 393, 568, 671, 640, 440, 627, 
    420, 66, 591, 665, 487, 294, 49, 340, 143, 132, 
    498, 509, 314, 65, 111, 526, 276, 407, 624, 272, 
    690, 176, 89, 62, 519, 412, 659, 326, 252, 718, 
    716, 388, 453, 566, 72, 723, 142, 531, 33, 510, 
    363, 365, 324, 629, 262, 77, 687, 2, 714, 158, 
    685, 179, 573, 149, 669, 458, 224, 338, 625, 266, 
    260, 703, 414, 310, 256, 402, 240, 16, 479, 518, 
    255, 654, 293, 445, 157, 434, 215, 91, 496, 139, 
    212, 483, 404, 390, 700, 664, 96, 188, 305, 287, 
    31, 285, 118, 577, 320, 523, 609, 268, 201, 90, 
    481, 650, 670, 547, 452, 541, 634, 524, 45, 284, 
    131, 456, 140, 707, 259, 44, 590, 418, 208, 544, 
    173, 594, 724, 674, 290, 170, 108, 511, 238, 545, 
    223, 598, 572, 346, 80, 658, 583, 630, 408, 161, 
    476, 548, 253, 435, 203, 30, 466, 423, 15, 152, 
    329, 382, 543, 710, 36, 667, 676, 462, 136, 668, 
    553, 141, 595, 722, 468, 708, 441, 236
};
